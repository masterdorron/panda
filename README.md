## üîß –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

**Panda** ‚Äî —ç—Ç–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ Flask-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω–æ–µ –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ CI/CD-–ø—Ä–æ—Ü–µ—Å—Å. –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–ª—É–∂–∏—Ç –∑–∞–≥–æ—Ç–æ–≤–∫–æ–π –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞–π–ø–ª–∞–π–Ω–∞ Jenkins –∏ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ Docker Compose.

> ‚ùó –ü—Ä–æ–µ–∫—Ç –Ω–∞–ø–∏—Å–∞–Ω –≤ —Ä–∞–º–∫–∞—Ö —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è. –û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å ‚Äî –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–≤—ã–∫–∏ —Ä–∞–±–æ—Ç—ã —Å Docker, Jenkins –∏ –æ—Å–Ω–æ–≤–∞–º–∏ DevOps-–ø—Ä–∞–∫—Ç–∏–∫.

---

## ‚öôÔ∏è –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Docker ‚â• 20.10  
- Docker Compose ‚â• 1.29  
- Jenkins —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ Docker (–µ—Å–ª–∏ CI/CD –±—É–¥–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –ª–æ–∫–∞–ª—å–Ω–æ)

---

## üìÅ –û–±–∑–æ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```
.
‚îú‚îÄ‚îÄ app.py                 # –ü—Ä–æ—Å—Ç–æ–π Flask-—Å–µ—Ä–≤–µ—Ä
‚îú‚îÄ‚îÄ requirements.txt       # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Flask
‚îú‚îÄ‚îÄ Dockerfile             # –°–±–æ—Ä–∫–∞ Python-–æ–±—Ä–∞–∑–∞
‚îú‚îÄ‚îÄ docker-compose.yml     # –ö–æ–º–±–∏–Ω–∏—Ä—É–µ—Ç —Å–µ—Ä–≤–∏—Å—ã (–≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –æ–¥–∏–Ω ‚Äî web)
‚îú‚îÄ‚îÄ Jenkinsfile            # –û–ø–∏—Å–∞–Ω–∏–µ Jenkins-–ø–∞–π–ø–ª–∞–π–Ω–∞
‚îî‚îÄ‚îÄ README.md              # –í–Ω–µ—à–Ω–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ (–º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ—Ä–∞–±–æ—Ç–∞–Ω–æ –ø–æ–¥ –ø—É–±–ª–∏—á–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ)
```

---

## üê≥ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è

### Dockerfile

–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ `python:3.11-slim`, –∫–æ–ø–∏—Ä—É–µ—Ç –∏—Å—Ö–æ–¥–Ω–∏–∫–∏ –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ `pip`.

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–æ–π:

```bash
docker-compose up --build
```

–ü—Ä–æ–≤–µ—Ä–∫–∞:

```bash
curl http://localhost:5000
```

---

## üåê Flask-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

`app.py` –∑–∞–ø—É—Å–∫–∞–µ—Ç HTTP-—Å–µ—Ä–≤–µ—Ä, –æ—Ç–≤–µ—á–∞—é—â–∏–π –Ω–∞ GET-–∑–∞–ø—Ä–æ—Å –∫–æ—Ä–Ω–µ–≤–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞:

```python
@app.route("/")
def home():
    return "Hello from Panda!"
```

---

## üîÑ CI/CD: Jenkins

### Jenkinsfile

Jenkins –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–∞–π–ø–ª–∞–π–Ω —Å declarative-—Å–∏–Ω—Ç–∞–∫—Å–∏—Å–æ–º. –≠—Ç–∞–ø—ã:

1. **Clone** ‚Äî —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤  
2. **Build Docker image** ‚Äî —Å–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞  
3. **Test** ‚Äî HTTP-–∑–∞–ø—Ä–æ—Å –∫ `http://localhost:5001` –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–∞  
4. **Run container** ‚Äî –∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (–≤ —Ñ–æ–Ω–µ)  
5. **Clean up** ‚Äî –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ —É–¥–∞–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞  

–î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã Jenkins –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –¥–æ—Å—Ç—É–ø –∫ Docker-—Å–æ–∫–µ—Ç—É  
(–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Docker-in-Docker –Ω–∞ –∞–≥–µ–Ω—Ç–µ).

## üöÄ –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ CI/CD –ø–∞–π–ø–ª–∞–π–Ω–∞

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ Jenkins (–ª–æ–∫–∞–ª—å–Ω–æ —á–µ—Ä–µ–∑ Docker)
```bash
docker run -d --name jenkins \
  -p 8080:8080 -p 50000:50000 \
  --network="host" \
  -v /var/run/docker.sock:/var/run/docker.sock \
  jenkins/jenkins:lts
```
–ó–∞—Ç–µ–º –æ—Ç–∫—Ä—ã—Ç—å http://localhost:8080, –≤–≤–µ—Å—Ç–∏ initial admin password (—Å–º. –≤ –ª–æ–≥–∞—Ö), —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–µ –ø–ª–∞–≥–∏–Ω—ã –∏ —Å–æ–∑–¥–∞—Ç—å job.

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ job –≤ Jenkins
–°–æ–∑–¥–∞–π—Ç–µ Pipeline job —Å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–º –∏–º–µ–Ω–µ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, panda-ci).

–í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö job –≤—ã–±–µ—Ä–∏—Ç–µ:

**Pipeline from SCM**

–¢–∏–ø: Git

URL: https://github.com/masterdorron/panda.git

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
### Prometheus

–ù–∞—Å—Ç—Ä–æ–π–∫–∞
–ö–æ–Ω—Ñ–∏–≥: prometheus.yml

–ó–∞–ø—É—Å–∫
```bash
docker run -d \
  -p 9090:9090 \
  --network="host" \
  -v /path/to/repo/prometheus.yml:/etc/prometheus/prometheus.yml \
  --name prometheus \
  prom/prometheus
```
–¶–µ–ª–∏ (targets)

Docker: localhost:9323
–í–∫–ª—é—á–∏—Ç—å –≤ /etc/docker/daemon.json:
```json
{
  "metrics-addr": "127.0.0.1:9323",
  "experimental": true
}
```
cAdvisor: localhost:8082

### cAdvisor
–ó–∞–ø—É—Å–∫
```bash
docker run -d \
  -p 8082:8080 \
  --network="host" \
  --name cadvisor \
  google/cadvisor:latest
```
### Grafana
–ó–∞–ø—É—Å–∫
```bash
docker run -d \
  -p 3000:3000 \
  --network="host" \
  --name grafana \
  grafana/grafana
```
–î–æ—Å—Ç—É–ø
http://localhost:3000
–õ–æ–≥–∏–Ω: admin
–ü–∞—Ä–æ–ª—å: admin

–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö
http://localhost:9090

–î–∞—à–±–æ—Ä–¥

CPU:
```bash
sum(rate(container_cpu_usage_seconds_total{name="app-container"}[1m]))
```
–ü–∞–º—è—Ç—å:
```bash
container_memory_usage_bytes{name="app-container"}
```
–û–ø–æ–≤–µ—â–µ–Ω–∏—è

CPU > 80% –≤ —Ç–µ—á–µ–Ω–∏–µ 1 –º–∏–Ω—É—Ç—ã:
–ü–∞–º—è—Ç—å > 500MB –≤ —Ç–µ—á–µ–Ω–∏–µ 1 –º–∏–Ω—É—Ç—ã:

